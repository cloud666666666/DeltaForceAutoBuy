# 🎮 三角洲行动 自动购买助手

> 智能化门卡价格监控与自动购买工具，助您抢购心仪的稀有门卡！

## 📋 项目简介

这是一个专为《三角洲行动》游戏设计的自动化购买助手，能够智能监控门卡价格并在符合条件时自动购买。支持定时启动、价格监控、OCR识别等多种功能，让您轻松获得心仪的游戏道具。

## 🎬 快速上手视频

想要快速了解如何使用？观看我们的运行演示视频：

<div align="center">
  <video width="80%" controls>
    <source src="https://github.com/cloud666666666/DeltaForceAutoBuy/raw/main/docs/Running.mp4" type="video/mp4">
    您的浏览器不支持视频标签。请 <a href="https://github.com/cloud666666666/DeltaForceAutoBuy/raw/main/docs/Running.mp4">点击这里下载视频</a> 查看演示。
  </video>
</div>

> 💡 **视频说明**：演示了从程序启动到自动购买的完整流程，包括配置设置、游戏窗口识别、价格监控和自动购买等核心功能。

**视频内容概览：**
- 🎯 程序启动和初始配置
- 🎮 游戏窗口设置和识别
- 💰 价格监控和OCR识别
- 🛒 自动购买流程演示
- ⚙️ 配置参数调整
- 📊 运行统计和日志查看

**备用访问方式：**
- 📱 [直接下载视频](https://github.com/cloud666666666/DeltaForceAutoBuy/raw/main/docs/Running.mp4)
- 🌐 [在线预览](https://github.com/cloud666666666/DeltaForceAutoBuy/blob/main/docs/Running.mp4)

## ✨ 主要功能

### 🎯 核心功能
- **智能价格监控** - 实时OCR识别门卡价格
- **自动购买决策** - 价格低于设定值时自动购买
- **定时启动** - 设定时间自动开始监控
- **运行时长控制** - 指定运行时间后自动停止
- **批量购买** - 支持设置购买数量

### 🛠️ 辅助功能
- **热键控制** - F8开始/F9停止/Ctrl+Shift+Q紧急退出
- **配置编辑器** - 程序内交互式配置修改
- **价格统计** - 自动记录和统计价格数据
- **日志记录** - 详细的操作日志和价格记录
- **管理员权限检查** - 自动检测并提示权限问题

### 🔧 技术特性
- **游戏窗口识别** - 自动检测并适配游戏窗口
- **OCR文字识别** - 内置Tesseract引擎，无需额外安装
- **路径智能处理** - 支持开发环境和打包后的exe
- **配置持久化** - 修改的配置正确保存，不会丢失

## 📁 文件结构

```
DeltaForceAutoBuy/
├── main.py                         # 主程序文件
├── keys.json                       # 配置文件
├── requirements.txt                # Python依赖包
├── README.md                       # 使用说明
├── LICENSE                         # MIT许可证
├── docs/                           # 文档和媒体文件
│   ├── Running.mp4                 # 运行演示视频
│   └── wechat_reward.jpg           # 微信打赏码
├── .venv/                          # Python虚拟环境
└── Tesseract/                      # OCR识别引擎
    ├── tesseract.exe              # OCR主程序
    ├── tessdata/                  # 语言包
    └── ...                        # 其他依赖文件
```

## 🚀 快速开始

### 系统要求
- **操作系统**：Windows 10/11
- **Python版本**：3.8+
- **游戏**：三角洲行动 (Delta Force)
- **权限**：管理员权限 (用于键盘热键功能)

### 安装步骤

1. **克隆项目**：
   ```bash
   git clone https://github.com/cloud666666666/DeltaForceAutoBuy.git
   cd DeltaForceAutoBuy
   ```

2. **激活虚拟环境**：
   ```bash
   .venv\Scripts\activate
   ```

3. **安装依赖**（首次运行）：
   ```bash
   pip install -r requirements.txt
   ```

4. **运行程序**：
   ```bash
   python main.py
   ```

### 管理员权限运行
如需使用热键功能，请以管理员身份运行：
```bash
# 右键命令提示符 → 以管理员身份运行
cd /d "项目路径"
.venv\Scripts\activate
python main.py
```

## ⚙️ 配置说明

### keys.json 配置文件
```json
{
    "keys": [
        {
            "max_price": 99999999,         // 最高购买价格
            "position": [0.3517, 0.2678],  // 门卡点击位置(屏幕百分比)
            "detail_price_region": {        // 价格识别区域
                "top_left": [0.7795, 0.8211],
                "bottom_right": [0.8862, 0.882]
            },
            "buyAmount": 3,                 // 购买数量
            "scheduledTime": "17:49",       // 定时购买时间(24小时制)
            "runDuration": 10               // 运行时长(分钟)
        }
    ]
}
```

### 配置参数说明

| 参数 | 说明 | 示例 |
|------|------|------|
| `max_price` | 最高购买价格，超过此价格不购买 | `50000` |
| `position` | 门卡在屏幕上的点击位置(百分比) | `[0.35, 0.27]` |
| `detail_price_region` | 价格文字的识别区域 | 见上方示例 |
| `buyAmount` | 购买数量 | `3` |
| `scheduledTime` | 定时购买时间，格式HH:MM | `"17:49"` |
| `runDuration` | 运行时长，分钟为单位 | `10` |

## 🎮 使用指南

### 1. 游戏配置要求

**重要：程序运行前请先按以下步骤配置游戏！**

1. **启动三角洲行动游戏**
2. **进入游戏设置**：主菜单 → 设置 → 视频
3. **推荐配置**：
   ```
   显示模式：窗口
   分辨率：1920x1080
   显示区域纵横比：16:9
   ```
4. **应用并重启游戏**

**为什么需要这样配置？**
- 窗口模式：程序能更准确地识别游戏窗口位置
- 1920x1080分辨率：程序的坐标系统基于此分辨率优化
- 16:9比例：确保界面元素位置准确

### 2. 启动流程

1. **配置游戏窗口**（见上面说明）
2. **运行程序**：`python main.py`
3. **首次配置**：根据提示设置参数
4. **开始监控**：按F8开始或等待定时启动

### 3. 热键说明

- **F8**：手动开始购买流程
- **F9**：停止程序并显示统计
- **Ctrl+Shift+Q**：紧急退出

### 4. 使用步骤

1. 在游戏中打开门卡购买界面
2. 启动程序，按F8开始监控
3. 程序会自动：
   - 识别当前价格
   - 与设定价格比较
   - 价格合适时自动购买
   - 购买达到设定数量后停止

## 🔧 常见问题与解决方案

### Q1: 程序无法启动
**A: 环境和权限问题**
- ✅ 确保已激活虚拟环境：`.venv\Scripts\activate`
- ✅ 安装所有依赖：`pip install -r requirements.txt`
- ✅ 以管理员身份运行命令提示符（用于热键功能）

### Q2: 热键不工作 (F8/F9无反应)
**A: 权限问题**
- ✅ 必须以管理员身份运行命令提示符
- ✅ 检查其他程序是否占用了热键

### Q3: 价格识别不准确
**A: 配置问题**
- ✅ **检查游戏分辨率**：必须设置为1920x1080窗口模式
- ✅ **检查显示缩放**：Windows显示缩放应设置为100%
- ✅ 确保游戏界面清晰可见，价格数字完整显示

### Q4: 程序点击位置不准确
**A: 分辨率和缩放问题**
- ✅ **确认游戏分辨率**：必须设置为1920x1080窗口模式
- ✅ **检查Windows显示缩放**：右键桌面→显示设置→缩放设置为100%
- ✅ **避免移动窗口**：程序运行时不要移动游戏窗口

### Q5: 配置修改后不生效
**A: 配置文件问题**
- ✅ 检查 `keys.json` 文件格式是否正确
- ✅ 重启程序重新加载配置
- ✅ 确保文件编码为UTF-8

### Q6: 误购买不想要的物品
**A: 安全设置**
- ✅ 降低 `max_price` 设置
- ✅ 减少 `buyAmount` 数量
- ✅ 使用定时购买而非手动触发

## 📊 日志和统计

### 日志文件
程序会在同目录下生成 `price_log.txt` 文件，记录：
- 价格监控记录
- 购买决策过程
- 成功/失败记录

### 价格统计
程序停止时会显示本次运行的价格统计：
- 平均价格
- 最高价格
- 最低价格

## 🚨 注意事项

### ⚠️ 使用安全
- 请合理设置购买价格，避免高价误购
- 建议先用小数量测试功能
- 程序运行时不要移动游戏窗口
- 确保游戏界面清晰，避免被其他窗口遮挡

### 🔐 权限要求
- 需要管理员权限才能使用热键功能
- 如果拒绝权限，只能使用定时功能

### 🕐 时区说明
- 定时启动使用**系统本地时间**
- 不同时区的电脑上时间表现会不同
- 日志时间戳也是本地时间

## 🛠️ 开发说明

### 技术栈
- **Python 3.10** - 主要开发语言
- **pytesseract** - OCR文字识别
- **opencv-python** - 图像处理
- **pyautogui** - 屏幕操作
- **keyboard** - 键盘监听
- **pywin32** - Windows API

### 开发环境设置
```bash
# 克隆项目
git clone <repository-url>
cd DeltaForceKeyBot-1

# 创建虚拟环境（如果不存在）
python -m venv .venv

# 激活虚拟环境
.venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

## 📝 更新日志

### v2.2.0 (当前版本)
- ✅ 修复配置文件路径问题
- ✅ 优化OCR识别准确率
- ✅ 添加价格统计功能
- ✅ 改进配置编辑器
- ✅ 简化日志系统
- ✅ 移除exe打包，专注源码运行

### v2.1.0
- 支持双exe版本（完整版和简化版）
- 添加一键启动脚本

### v2.0.0
- 重构核心功能
- 基础价格监控功能
- 自动购买机制
- 热键控制

## 🤝 技术支持

如果遇到问题：
1. 检查是否按照游戏配置要求设置
2. 确认是否以管理员权限运行
3. 检查游戏分辨率和显示缩放
4. 查看控制台输出的错误信息
5. 检查 `price_log.txt` 日志文件

## ☕ 赞赏支持

如果这个项目对您有帮助，欢迎请作者喝杯咖啡☕

**您的支持就是作者开发和维护项目的动力🚀**

### 微信赞赏码
![微信赞赏码](./docs/wechat_reward.jpg)

*扫码支持开发者，您的每一份心意都是我们前进的动力！*

---

## 📞 联系作者

### 💡 功能建议与合作需求

如果您有以下需求，欢迎联系作者：

- 🚀 **新功能建议** - 希望添加特定功能
- 🤝 **商业合作** - 定制开发需求
- 🛠️ **技术支持** - 专业问题解答
- 💼 **项目合作** - 相关项目合作机会

### 📱 联系方式

**微信号：** `wyh2353493891`

*添加微信时请备注：DeltaForce项目咨询*

---

## 📄 免责声明

- 本工具仅供学习和个人使用
- 使用本工具的风险由用户自行承担
- 作者不对因使用本工具导致的任何损失负责
- 请合理使用，遵守游戏规则和相关法律法规
- 本工具不保证100%成功率，市场有风险，投资需谨慎

---

**🎮 祝您游戏愉快，抢购成功！**

> 💡 提示：首次使用建议仔细阅读游戏配置要求，确保程序正常工作。 